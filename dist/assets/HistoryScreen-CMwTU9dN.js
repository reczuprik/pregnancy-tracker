import{u as y,c as C,j as e,M as w}from"./index-CAEX3aWz.js";import{a as b}from"./charts-DuWgtHVV.js";import{g as L}from"./utils-CVIQWZOX.js";import{L as $}from"./vendor-C_5V_bIi.js";const M=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:"18",height:"18",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),O=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:"18",height:"18",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.033-2.134H8.71c-1.123 0-2.033.954-2.033 2.134v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),S=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",width:"18",height:"18",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})}),W=n=>Math.round(n/5)*5,I=({measurement:n,isExpanded:h,officialMeasurement:r,onClick:l,onSetOfficial:m,onDelete:x})=>{const{t}=y(),{date:d,gestationalWeek:j,gestationalDay:a,measurements:i,isOfficial:p,id:N}=n,o=C({date:d,...i});let u=n.gestationalWeek,v=n.gestationalDay;if(r){const s=r.gestationalWeek*7+r.gestationalDay,c=new Date(r.date),k=new Date(n.date),D=L(k,c),g=s+D;u=Math.floor(g/7),v=g%7}const f=(s,c)=>{s.stopPropagation(),c(s,N)};return e.jsxs("div",{className:`accordion-measurement-card ${h?"expanded":""} ${p===1?"official":""}`,onClick:l,children:[e.jsxs("div",{className:"card-header-collapsed",children:[e.jsx("div",{className:"collapsed-info",children:e.jsx("div",{className:"card-title",children:d})}),e.jsx("div",{className:"collapsed-age",children:e.jsx("div",{className:"age-value",children:`${u}${t("results.weeks")} ${v}${t("results.days")}`})}),e.jsx("div",{className:"chevron-container",children:e.jsx(S,{})})]}),e.jsx("div",{className:"card-details-wrapper",children:e.jsxs("div",{className:"card-details-content",children:[e.jsxs("div",{className:"details-section",children:[e.jsx("div",{className:"details-section-title",children:t("history.measurementDataTitle")}),e.jsx("div",{className:"card-body",children:Object.entries(i).map(([s,c])=>c==null?null:e.jsxs("div",{className:"measurement-item",children:[e.jsx("span",{children:t(`measurement.form.${s.replace("_mm","")}`)}),e.jsxs("span",{children:[c,"mm"]})]},s))})]}),o?.percentiles&&o.percentiles.length>0&&e.jsxs("div",{className:"details-section",children:[e.jsx("div",{className:"details-section-title",children:t("history.growthAnalysisTitle")}),e.jsxs("div",{className:"card-body",children:[o.percentiles.map(s=>e.jsxs("div",{className:"measurement-item",children:[e.jsx("span",{children:t("history.growthRateLabel",{parameter:s.parameter})}),e.jsxs("span",{className:"reassurance-text",children:["~",W(s.percentile),"th (",t("history.reassuranceText"),")"]})]},s.parameter)),p!==1&&e.jsxs("div",{className:"measurement-item-deemphasized",children:[e.jsx("span",{children:t("history.estimatedAgeFromSize")}),e.jsx("span",{children:`${o.gestationalWeek}w ${o.gestationalDay}d`})]})]})]}),e.jsxs("div",{className:"card-actions",children:[p!==1&&e.jsx("button",{className:"icon-button",onClick:s=>f(s,m),children:e.jsx(M,{})}),e.jsx("button",{className:"icon-button danger",onClick:s=>f(s,x),children:e.jsx(O,{})})]})]})}),e.jsx("div",{className:"official-strip"})]})},P=({measurements:n,officialMeasurement:h,onMeasurementsChange:r})=>{const{t:l}=y(),[m,x]=b.useState(null),t=async(a,i)=>{a.stopPropagation(),window.confirm(l("history.confirmDelete"))&&(await w.deleteMeasurement(i),r())},d=async(a,i)=>{a.stopPropagation(),await w.setOfficialMeasurement(i),r()},j=a=>{x(i=>i===a?null:a)};return n.length===0?e.jsx("div",{className:"history-view-container",children:e.jsx("p",{className:"no-data-message",children:l("history.noData")})}):e.jsxs("div",{className:"history-view-container",children:[e.jsx("div",{className:"btn-group",children:e.jsx($,{to:"/journey",className:"btn btn-secondary btn-full",children:l("history.actions.chart")})}),e.jsx("div",{className:"timeline-container",children:n.map(a=>e.jsx(I,{measurement:a,officialMeasurement:h||void 0,isExpanded:m===a.id,onClick:()=>j(a.id),onSetOfficial:d,onDelete:t},a.id))})]})};export{P as default};
//# sourceMappingURL=HistoryScreen-CMwTU9dN.js.map
