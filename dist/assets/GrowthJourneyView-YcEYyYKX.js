import{u as v,A as k,H as L,B as w,F as D,C as R,j as a}from"./index-CAEX3aWz.js";import{R as P,a as x,L as S,C as $,b as A,d as O,P as I,e as T,p as W,f as B,h as H,i as G}from"./charts-DuWgtHVV.js";import{g as F}from"./utils-CVIQWZOX.js";import{N as V}from"./vendor-C_5V_bIi.js";$.register(A,O,I,T,W,B,H,G);const q=l=>{let s=l.canvas.parentNode.querySelector("div");if(!s){s=document.createElement("div"),s.className="chart-tooltip-container";const n=document.createElement("div");n.className="chart-tooltip",s.appendChild(n),l.canvas.parentNode.appendChild(s)}return s},C=l=>getComputedStyle(document.documentElement).getPropertyValue(l).trim(),J=({measurements:l,parameter:s,officialMeasurement:n})=>{const{t:e}=v(),i=x.useMemo(()=>{const d={crl_mm:R,fl_mm:D,bpd_mm:w,hc_mm:L,ac_mm:k}[s];if(!d)return null;const o=l.map(t=>{let m;if(n){const b=n.gestationalWeek*7+n.gestationalDay,E=new Date(n.date),_=new Date(t.date),j=F(_,E);m=b+j}else m=t.gestationalWeek*7+t.gestationalDay;const r=t.measurements[s];return r==null||r<=0?null:{x:m/7,y:r,isOfficial:t.id===n?.id,measurement:t}}).filter(t=>t!==null),c=o.map(t=>t.x),h=Math.floor(Math.min(...c,...Object.keys(d).map(Number))),f=Math.ceil(Math.max(...c,...Object.keys(d).map(Number))),p=t=>{const m=[];for(let r=h;r<=f;r++)d[r]&&m.push({x:r,y:d[r][t]});return m},u=C("--color-accent-primary"),y=C("--color-accent-secondary");return{datasets:[{label:e("charts.typicalRange"),data:p(0),backgroundColor:"rgba(178, 216, 216, 0.2)",borderColor:"transparent",pointRadius:0,fill:"+1",order:4},{label:"Boundary",data:p(2),borderColor:"transparent",pointRadius:0,fill:!1,order:3},{label:e("charts.medianJourney"),data:p(1),borderColor:y,borderWidth:2,pointRadius:0,fill:!1,order:2},{label:e("charts.yourBaby"),data:o,pointRadius:o.map(t=>t.isOfficial?8:6),pointHoverRadius:o.map(t=>t.isOfficial?10:8),backgroundColor:o.map(t=>t.isOfficial?y:u),borderColor:o.map(t=>t.isOfficial?y:u),showLine:!1,order:1}],minWeek:h,maxWeek:f}},[l,s,n,e]),N=x.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:e("charts.title",{parameter:s.replace("_mm","").toUpperCase()}),font:{size:18,weight:600},padding:{top:10,bottom:20}},tooltip:{enabled:!1,external:g=>{const{chart:d,tooltip:o}=g,c=q(d);if(o.opacity===0){c.style.opacity=0;return}if(!o.dataPoints?.[0]?.raw?.measurement){c.style.opacity=0;return}if(o.body){const p=o.dataPoints[0],u=p.raw.measurement,y=p.raw.y,t=u.gestationalWeek,m=u.gestationalDay,r=c.querySelector(".chart-tooltip");if(!r)return;const b=`
              <div class="tooltip-title">${e("charts.tooltipIntro")}</div>
              <div class="tooltip-body">
                <span class="value">${t}${e("results.weeks")} ${m}${e("results.days")}: ${y}mm</span>
                <span class="context">${e("charts.tooltipGrowth")}</span>
              </div>
            `;r.innerHTML=b}const{offsetLeft:h,offsetTop:f}=d.canvas;c.style.opacity=1,c.style.left=h+o.caretX+"px",c.style.top=f+o.caretY+"px"}}},scales:{x:{type:"linear",title:{display:!0,text:e("charts.xAxisLabel")},grid:{color:"#f8fafc"},min:i?.minWeek,max:i?.maxWeek},y:{title:{display:!0,text:e("charts.yAxisLabel")},grid:{color:"#f1f5f9"},beginAtZero:!0}}}),[e,s,i]);return i?a.jsx("div",{style:{position:"relative",height:"400px",marginTop:"20px"},children:a.jsx(S,{options:N,data:i})}):null},U=P.memo(J),K=({measurements:l,officialMeasurement:s})=>{const{t:n}=v(),[e,i]=x.useState("crl_mm");return a.jsxs("div",{className:"growth-journey-view",children:[a.jsx("div",{className:"view-header",children:a.jsxs(V,{to:"/history",className:"btn btn-secondary btn-full",children:["< ",n("history.actions.hideChart")]})}),a.jsxs("div",{className:"chart-analytics-area",children:[a.jsxs("div",{className:"chart-controls",children:[a.jsxs("div",{className:"measurement-group early-pregnancy",children:[a.jsx("span",{className:"group-label",children:"Early Pregnancy"}),a.jsx("div",{className:"group-buttons",children:a.jsx("button",{onClick:()=>i("crl_mm"),className:`btn-tertiary ${e==="crl_mm"?"active":""}`,children:"CRL"})})]}),a.jsxs("div",{className:"measurement-group later-pregnancy",children:[a.jsx("span",{className:"group-label",children:"Biometric Parameters"}),a.jsxs("div",{className:"group-buttons",children:[a.jsx("button",{onClick:()=>i("bpd_mm"),className:`btn-tertiary ${e==="bpd_mm"?"active":""}`,children:"BPD"}),a.jsx("button",{onClick:()=>i("hc_mm"),className:`btn-tertiary ${e==="hc_mm"?"active":""}`,children:"HC"}),a.jsx("button",{onClick:()=>i("ac_mm"),className:`btn-tertiary ${e==="ac_mm"?"active":""}`,children:"AC"}),a.jsx("button",{onClick:()=>i("fl_mm"),className:`btn-tertiary ${e==="fl_mm"?"active":""}`,children:"FL"})]})]})]}),a.jsx(U,{measurements:l,parameter:e,officialMeasurement:s})]})]})};export{K as default};
//# sourceMappingURL=GrowthJourneyView-YcEYyYKX.js.map
